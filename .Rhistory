#geom_boxplot(data=summary, aes(x=Tissue2, y=mean*100, fill=Cohort),alpha=0.6,
#             position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue2, y=mean*100, color=Cohort), color='gray60',
alpha=0.4,size=2,
position=position_jitterdodge(position_jitterdodge(jitter.width = 0.1,
jitter.height = 0, dodge.width = 0.8)))
#Read the data file
summary<-read.csv("Data/Average_Diversity_R21.csv", stringsAsFactors = F)
ggplot()+
geom_boxplot(data=summary, aes(x=Cohort, y=mean*100, fill=Cohort))
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8),color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"80"))+
xlab('')+ylab('% Average diversity')+
theme_bw()
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8),color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"80"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
# 1) calculate the averages for each tissues within each cohort
Tis.mean<-aggregate(summary[,"mean"],by=list(summary$Cohort, summary$Tissue), mean)
colnames(Tis.mean)<-c("Cohort", "Tissue","Mean")
# 2)Order the tissues
summary$Tissue<-factor(summary$Tissue, levels = c("Plasma","Plasma nex","Peripheral LN","Thoracic LN","Lung"))
Tis.mean$Tissue<-factor(Tis.mean$Tissue, levels = c("Plasma","Plasma nex","Peripheral LN","Thoracic LN","Lung"))
# Plot the boxplot and mean points together!
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
#geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
#             position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, color=Cohort), color='gray60',
alpha=0.4,size=2,
position=position_jitterdodge(position_jitterdodge(jitter.width = 0.1,
jitter.height = 0, dodge.width = 0.8)))
ggplot()+
#geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
#             position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, color=Cohort),alpha=0.6,
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.5), size=2)
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, color=Cohort),alpha=0.6,
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, color=Cohort),alpha=0.6,
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2, color="gray40")+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),color="gray60",alpha=0.6,
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, color=Cohort),alpha=0.8,
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, color=Cohort),alpha=0.8,
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
scale_color_manual(values=paste0(colors[c(5,3,1)]))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, color=Cohort),
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
scale_color_manual(values=paste0(colors[c(5,3,1)],"33"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, color=Cohort),
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, color=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, color=Cohort),
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),color="gray60",
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
#scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),color="gray60",alpha=0.6
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
#scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),color="gray60",alpha=0.6,
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
#scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),color="gray60",alpha=0.6,
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=1.5)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
#scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),color="gray60",alpha=0.6,
position=position_jitterdodge(jitter.width = 0.05,jitter.height = 0,
dodge.width = 0.8), size=1.5)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
#scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),color="gray60",alpha=0.7,
position=position_jitterdodge(jitter.width = 0.05,jitter.height = 0,
dodge.width = 0.8), size=1.5)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
#scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),color="gray50",alpha=0.7,
position=position_jitterdodge(jitter.width = 0.05,jitter.height = 0,
dodge.width = 0.8), size=1.5)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
#scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),color="gray50",alpha=0.3,
position=position_jitterdodge(jitter.width = 0.05,jitter.height = 0,
dodge.width = 0.8), size=1.5)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
#scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),color="gray50",alpha=0.4,
position=position_jitterdodge(jitter.width = 0.05,jitter.height = 0,
dodge.width = 0.8), size=1.5)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
#scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
### show palette colors
hcl_palettes(plot = TRUE)
hcl_palettes("qualitative", plot = TRUE)
hcl_palettes("qualitative", 6, plot = TRUE)
hcl_palettes("qualitative", n=6, plot = TRUE)
#Plot using theme_bw()
ggplot()+
geom_boxplot(data=summary, aes(x=Cohort, y=mean*100, fill=Cohort),
color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"), guide='none')+
xlab('')+ylab('% Average diversity')+
theme_bw()
#Plot using theme_bw()
ggplot()+
geom_boxplot(data=summary, aes(x=Cohort, y=mean*100, fill=Cohort),
color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"), guide='none')+
xlab('')+ylab('% Average diversity')+
theme_classic()
#Plot using theme_bw()
ggplot()+
geom_boxplot(data=summary, aes(x=Cohort, y=mean*100, fill=Cohort),
color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"), guide='none')+
xlab('')+ylab('% Average diversity')+
theme_bw()
ggplot()+
geom_boxplot(data=summary, aes(x=Cohort, y=mean*100, fill=Cohort),
color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"), guide='none')+
xlab('')+ylab('% Average diversity')+
theme_bw()
# Make Cohort as 'factor'
summary$Cohort<-factor(summary$Cohort, levels=c(coh))
ggplot()+
geom_boxplot(data=summary, aes(x=Cohort, y=mean*100, fill=Cohort),
color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"), guide='none')+
xlab('')+ylab('% Average diversity')+
theme_bw()
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8),color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"80"))+
xlab('')+ylab('% Average diversity')+
theme_bw()
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8),color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"80"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8),color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8),color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
# 1) calculate the averages for each tissues within each cohort
Tis.mean<-aggregate(summary[,"mean"],by=list(summary$Cohort, summary$Tissue), mean)
colnames(Tis.mean)<-c("Cohort", "Tissue","Mean")
# 2)Order the tissues
summary$Tissue<-factor(summary$Tissue, levels = c("Plasma","Plasma nex","Peripheral LN","Thoracic LN","Lung"))
Tis.mean$Tissue<-factor(Tis.mean$Tissue, levels = c("Plasma","Plasma nex","Peripheral LN","Thoracic LN","Lung"))
# Plot the boxplot and mean points together!
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),color="gray50",alpha=0.4,
position=position_jitterdodge(jitter.width = 0.05,jitter.height = 0,
dodge.width = 0.8), size=1.5)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
#scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, color=Cohort),
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),alpha=0.6,
position=position_dodge(width = 0.8), color="gray40")+
geom_point(data=summary, aes(x=Tissue, y=mean*100, color=Cohort),
position=position_jitterdodge(jitter.width = 0.1,jitter.height = 0,
dodge.width = 0.8), size=2)+
geom_point(data=Tis.mean, aes(x=Tissue, y=Mean*100, fill=Cohort, shape=Cohort), size=2,shape=4,
position = position_dodge(width = 0.8), color=1, show.legend = F)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
scale_color_manual(values=paste0(colors[c(5,3,1)],"4D"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank(), legend.title = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
#If you don't have the above packages, install them:
install.packages(ggplot2)
install.packages('colorspace')
install.packages("colorspace")
install.packages("colorspace")
install.packages('colorspace')
ggplot()+
geom_boxplot(data=summary, aes(x=Cohort, y=mean*100, fill=Cohort))
#load necessary libraries
library(ggplot2)
library(colorspace)
#Read the data file
summary<-read.csv("Data/Average_Diversity_R21.csv", stringsAsFactors = F)
ggplot()+
geom_boxplot(data=summary, aes(x=Cohort, y=mean*100, fill=Cohort))
#Plot using theme_bw()
ggplot()+
geom_boxplot(data=summary, aes(x=Cohort, y=mean*100, fill=Cohort),
color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()
#my color vector
colors<-qualitative_hcl(6, palette="Dark3")
#Plot using theme_bw()
ggplot()+
geom_boxplot(data=summary, aes(x=Cohort, y=mean*100, fill=Cohort),
color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()
## Improve the figure by ordering independent variables (X-axis). This is done by using 'factor'.
# For these data, we want to order cohorts in the following order
coh<-c("SIV only","Mtb NR","Mtb R")
# Make Cohort as 'factor'
summary$Cohort<-factor(summary$Cohort, levels=c(coh))
ggplot()+
geom_boxplot(data=summary, aes(x=Cohort, y=mean*100, fill=Cohort),
color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"), guide='none')+
xlab('')+ylab('% Average diversity')+
theme_bw()
## Can you add the means for each group (cohort) to the following box plot?
ggplot()+
geom_boxplot(data=summary, aes(x=Cohort, y=mean*100, fill=Cohort),
color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"), guide='none')+
xlab('')+ylab('% Average diversity')+
theme_bw()
ggplot()+
####################################################################
## 2. Plot the diversity by Tissue type by Cohort (Group bar chart)
# use position_dodge()
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8),color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8),color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()
levels(summary$Tissue)
# Plot the box plot and means together!
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8),color="gray20", outlier.alpha = 0.6)+
scale_fill_manual(values=paste0(colors[c(5,3,1)],"66"))+
xlab('')+ylab('% Average diversity')+
theme_bw()+
theme(panel.grid.major.x = element_blank())+
geom_vline(xintercept=1:4+0.5, color="gray50")
ggplot()+
geom_boxplot(data=summary, aes(x=Tissue, y=mean*100, fill=Cohort),
position=position_dodge(width = 0.8), color="gray40")
